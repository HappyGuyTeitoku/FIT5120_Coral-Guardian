<!-- templates/testpage.html -->
{% extends "base_v2.html" %}

{% block title %}What is Nutrient Pollution? - AquaGuard{% endblock %}

{% block content %}
<div class="spacer"></div>

<div class="image-banner-1">
    <img src="{{ url_for('static', filename='title.jpg') }}" alt="Your Image">
</div>

<div class="specific-container"> <!-- Start of the specific container -->

    <div class="container-20 education-page">
        <div class="content">
            <!-- <div style="text-align: center;">
                    <img src="{{ url_for('static', filename='greenshoreline-with-boat.jpg') }}" alt="Your Image" style="width: 100px; height: auto;">
                </div> -->
            <p class="page-title">Nutrient Pollution</p>

            <div class="spacer-half"></div>
        </div>
    </div>

    <!-- New Code Starts Here -->
    <div class="container">
        <!-- Header -->

        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-button active" onclick="openTab('overview')">Overview</button>
            <button class="tab-button" onclick="openTab('impact')">Impact</button>
            <button class="tab-button" onclick="openTab('action')">Action</button>
        </div>

        <!-- Tab Content -->
        <div id="overview" class="tab-content active">
            <!-- Overview Content -->
            <div class="overview-background">
                <div class="nutrient-info">
                    <p class="centered-text">Nutrient pollution refers to the excessive input of nutrients (primarily
                        nitrogen and phosphorus) into water bodies, leading to an imbalance in aquatic ecosystems. These
                        nutrients are essential elements for plant growth, but when their concentrations exceed the
                        ecosystem's carrying capacity, they trigger a series of environmental issues.</p>
                    <div class="nutrient-details">
                        <div class="nutrient-item">
                            <p class="nutrient-title">Nitrogen (N)</p>
                            <p class="nutrient-description">Forms: Mainly exists as nitrates and ammonium salts<br>
                                Sources: Fertilizers, sewage, atmospheric deposition<br>
                                Effects: Promotes excessive growth of algae and aquatic plants</p>
                        </div>
                        <div class="nutrient-item">
                            <p class="nutrient-title">Phosphorus (P)</p>
                            <p class="nutrient-description">Forms: Mainly exists as phosphates<br>
                                Sources: Detergents, fertilizers, eroded soil<br>
                                Effects: Often the key limiting factor for algal growth in freshwater systems</p>
                        </div>
                        
                    </div>
                </div>
                <div class="nutrient-info-1">
                    <p class="centered-text-1">Why is this important to you?</p>
                    <p class="centered-text-subdesc">*      Impact on Outdoor Activities: Nutrient pollution can trigger algae blooms, affecting your favorite activities like fishing, boating, and swimming, and may even lead to closures of water bodies.<br>
                        *       Risk to Family Health: Polluted water sources can affect the quality of drinking water, increase the cost of domestic water treatment, and pose health risks to your family and pets.<br>
                        *       Sustainable Lifestyle: By choosing phosphate-free cleaning products and reducing the excessive use of chemicals, you can help reduce the impact of nutrient pollution and create a healthier future for your children.</p>


                <div class="nutrient-info-1">
                    <p class="centered-text-1">Main Sources of Nutrient Pollution</p>
                    <p class="centered-text-subdesc">*      Household Cleaners: Phosphorus-containing cleaning products enter sewers and eventually water bodies, increasing nutrient loads.<br>
                        *       Urban Stormwater Runoff: Rainwater carries pollutants from streets and parks into rivers and lakes, impacting water quality.<br>
                        *   Home Gardening: Excessive use of fertilizers can enter water bodies through surface runoff, further exacerbating nutrient pollution.</p>

                <div class="fkwebsite">
                    <img src="{{ url_for('static', filename='fkthis.jpg') }}" alt="">
                </div>       
                
                <button class="explore-button" onclick="window.location.href='{{ url_for('waterqualitymap') }}'">
                    Explore Water Quality in Your Area
                    
                </button>
                <div class="fkwebsite">
                    <img src="{{ url_for('static', filename='fkthis.jpg') }}" alt="">
                </div>
                


                <div class="video-section" style="display: block;">
                    <div id="video-container1" style="display: none;">
                        <div id="player1"></div>
                    </div>
                    <img id="video-thumbnail1" src="https://img.youtube.com/vi/vCicSNnKUvM/hqdefault.jpg" alt="Video Thumbnail" style="cursor: pointer;">
                </div>
                
                <script src="/static/script.js"></script>

                <div class="fkwebsite">
                    <img src="{{ url_for('static', filename='fkthis.jpg') }}" alt="">
                </div>
                
                <!------------------------------------------------ OVERVIEW quiz ----------------------------------------------------------------------------------------->
                <div id="progress-bar">
                    <progress id="progress" value="0" max="100"></progress>
                    
                </div>
        
        
                <div id="quiz-container" class="testpage-quiz">
            <div class="start" style="display: block;">
                <p>Put your new knowledge on updates to the test, take our quiz!</p>
                  <button>Start Quiz</button>
            </div>
            <!-- 进度条 -->
            

             <div class="game" style="display: none;">
                

                <span id="progress-text">Question 1 of 3</span>
                
    
                <div class="question" id="question-1" data-correct="2" style="display: none;">
                    <p></p>
                    
                    <div id="option-container">
                        
                    </div>
                    <button id="next-option" style="display: none;">Next</button> <!-- 唯一的按鈕 ID -->
                </div>
                
                <div class="question" id="question-2" data-correct="0" style="display: none;">
                    <p></p>
                    <div id="option-container">
                        
                    </div>
                    <button id="next-option" style="display: none;">Next</button>
                </div>
    
                <div class="question" id="question-3" data-correct="0" style="display: none;">
                    <p></p>
                    <div id="option-container">
                        
                    </div>
                    <button id="next-option" style="display: none;">Done</button>
                </div>
             </div>
            <script>
                 const start = document.querySelector('.start')
                 const game = document.querySelector('.game')
                 const button = document.querySelector('.start button')
                 button.addEventListener('click', () => {
                   start.style.display = 'none'
                   game.style.display = 'block'
                 })
            </script>


                <!-- 按鈕: 下一題 -->
                <div id="result"></div>
                
        </div>

        <!-- 結果顯示區域 -->
        
        </div>

        <script src="/static/script_quiz.js"></script>

            




                
            </div>
        </div>
        
<!------------------------------------------------ OVERVIEW quiz  END----------------------------------------------------------------------------------------->


        <!--  -----------------------------------------impact------------------------------------- -->
        
 
    </div>
    <div id="impact" class="tab-content">
        <!-- Impact Content -->
        <div class="impact-section">
            <!-- Image with Title -->
            
            <div class="impact-text">
                <p>
                    Nutrient pollution affects not only water quality but also our daily lives and outdoor activities. Understanding these impacts can help us take more effective measures.
                </p>
                <h2>Impact on Outdoor Activities</h2>
                
                <p>
                    <strong>Oxygen Depletion:</strong> Decomposing algae consumes oxygen, creating dead zones where
                    fish and other organisms cannot survive.
                </p>
                <p>
                    <strong>Biodiversity Loss:</strong> Continuous pollution reduces species diversity, weakening
                    the ecosystem's stability.
                </p>

                <p>
                    Nutrient pollution leads to algal blooms, which not only diminish the aesthetic quality of water bodies but also make them unsuitable for swimming, fishing, and boating. Additionally, algal blooms may produce toxic substances that can threaten the health of aquatic life and humans using these water bodies.
                </p>
                <div class="impact-image">
                    <img src="{{ url_for('static', filename='dfish.png') }}" alt="Dead Fish"
                        style="width: 100%; height: auto;">
                </div>
                <h2>Impact on Fish</h2>
                <p>

Nutrient pollution promotes excessive algae growth in water bodies, indirectly affecting the living conditions of fish. Large amounts of algae consume oxygen from the water, creating low-oxygen environments where fish struggle to survive, leading to a decline in fish populations. Additionally, some algae can produce toxins that directly poison fish and may even cause fish deaths
                </p>
               
                
            </div>


            <div class="fkwebsite">
                <img src="{{ url_for('static', filename='fkthis.jpg') }}" alt="">
            </div>

            
            <div id="progress-bar-quiz2">
                <progress id="progress-quiz2" value="0" max="100"></progress>
            </div>
            
            <div id="quiz-container-quiz2" class="testpage-quiz-quiz2">
                <div class="start-quiz2" style="display: block;">
                    <p>Put your new knowledge on updates to the test, take our quiz!</p>
                    <button>Start Quiz</button>
                </div>
            
                <!-- 进度条 -->
                <div class="game-quiz2" style="display: none;">
                    <span id="progress-text-quiz2">Question 1 of 3</span>
            
                    <div class="question-quiz2" id="question2-quiz2-1" data-correct="2" style="display: none;">
                        <p></p>
                        <div id="option-container-quiz2-1"></div>
                        <button id="next-option-quiz2" style="display: none;">Next</button> <!-- 唯一的按鈕 ID -->
                    </div>
            
                    <div class="question-quiz2" id="question2-quiz2-2" data-correct="0" style="display: none;">
                        <p></p>
                        <div id="option-container-quiz2-2"></div>
                        <button id="next-option-quiz2" style="display: none;">Next</button>
                    </div>
            
                    <div class="question-quiz2" id="question2-quiz2-3" data-correct="0" style="display: none;">
                        <p></p>
                        <div id="option-container-quiz2-3"></div>
                        <button id="next-option-quiz2" style="display: none;">Done</button>
                    </div>
                </div>

                <script>
                    const startQuiz2 = document.querySelector('.start-quiz2');
                    const gameQuiz2 = document.querySelector('.game-quiz2');
                    const buttonQuiz2 = document.querySelector('.start-quiz2 button');
                    buttonQuiz2.addEventListener('click', () => {
                        startQuiz2.style.display = 'none';
                        gameQuiz2.style.display = 'block';
                    });
                </script>
                
            
                <!-- 按鈕: 下一題 -->
                <div id="result-quiz2"></div>
            </div>


    <!--  -----------------------------------------impact----------end--------------------------- -->

    <!--  -----------------------------------------action------------------------------------- -->

    
    </div>
    





<!-- Video Element (initially hidden) -->
<div id="video-container" class="video-container" style="display: none;">
    <video id="video-player" controls width="640">
        <source id="video-source" src="" type="video/mp4">
        Your browser does not support the video tag.
    </video>
    <button id="close-video">Close</button>
</div>

</div>
<div id="action" class="tab-content">
    <section class="action-section">
        <div class="action-item">
            <div class="action-text">
                <h2>Choose Eco-Friendly Cleaning Products</h2>
                <p>Did you know your daily cleaning agents might contain harmful phosphates? These chemicals can
                    pollute our water. Choose phosphate-free, biodegradable products to help protect our rivers
                    and lakes. Make the switch today to eco-friendly cleaning and keep your home safe.</p>
                    <button class="action-button" onclick="window.location.href='{{ url_for('productsearch') }}'">
                        Explore Eco-Friendly Cleaning Products
                    </button>
            </div>
            <div class="action-image">
                <img src="{{ url_for('static', filename='clean.png') }}" />
            </div>
        </div>

        <div class="action-item reverse">
            <div class="action-text">
                <h2>Do You Know What You’re Using? Understand Your Cleaning Agents</h2>
                <p>What harmful ingredients are in your daily cleaning agents? Phosphates, surfactants,
                    bleach—these can harm aquatic ecosystems and your health. Learn about product ingredients to
                    make eco-friendly choices and reduce your impact. Protect the planet, starting with your
                    products.</p>
                <button class="action-button" onclick="window.location.href='{{ url_for('productsearch') }}'">
                    Check Cleaning Agent Ingredients</button>
            </div>
            <div class="action-image">
                <img src="{{ url_for('static', filename='clean1.png') }}" />
            </div>
        </div>

        <div class="action-item">
            <div class="action-text">
                <h2>Dispose of Cleaning Products Properly to Avoid Secondary Pollution</h2>
                <p>How should you dispose of leftover cleaning products? Improper disposal can cause serious
                    environmental pollution and threaten drinking water. Learn proper disposal methods, choose
                    recycling, and help protect clean water for future generations.</p>
                <button class="action-button" onclick="window.location.href='{{ url_for('learnmore') }}'">

                Learn Disposal Methods</button>
            </div>
            <div class="action-image">
                <img src="{{ url_for('static', filename='stuff.png') }}" />
            </div>
        </div>

        <div class="page-title" style="color: #70C174;">Find Nearby Recycling Center</div>

        <div id="map"></div>

        <script>
            let map;
            let directionsService;
            let directionsRenderer;
            let currentInfoWindow = null;

            function initMap() {
                map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 10,
                    center: { lat: -37.8136, lng: 144.9631 } // Center the map on Melbourne
                });

                // Initialize DirectionsService and DirectionsRenderer
                directionsService = new google.maps.DirectionsService();
                directionsRenderer = new google.maps.DirectionsRenderer();
                directionsRenderer.setMap(map);

                // Retrieve addresses along with event times from the raw data
                const rawData = {{ event_schedule_data | tojson
            }};
            const headers = rawData[0];
            const processed_data = rawData.slice(1).map(row => {
                let rowData = {};
                headers.forEach((header, index) => {
                    rowData[header] = row[index];
                });
                return rowData;
            });
            const addresses = getAddresses(processed_data);

            geocodeAddresses(addresses, map, (geocodedAddresses, map) => {
                addWaypointsToMap(geocodedAddresses, map);
                addDetailsToWaypoints(geocodedAddresses, map);
            });

            // Close the currently open InfoWindow when clicking on the map
            map.addListener('click', () => {
                if (currentInfoWindow) {
                    currentInfoWindow.close();
                }
            });
}

            function getAddresses(rawData) {
                return rawData.map(row => ({
                    address: `${row.address}, ${row.suburb}, ${row.state} ${row.postal_code}`,
                    location: row.location,
                    date: row.date,
                    time_begin: row.time_begin,
                    time_end: row.time_end,
                    location_name: row.location_name
                }));
            }

            function geocodeAddresses(addresses, map, callback) {
                const geocoder = new google.maps.Geocoder();
                const geocodePromises = addresses.map(address =>
                    new Promise((resolve, reject) => {
                        geocoder.geocode({ 'address': address.address }, (results, status) => {
                            if (status === 'OK') {
                                resolve({
                                    position: results[0].geometry.location,
                                    address: address.address,
                                    location: address.location,
                                    date: address.date,
                                    time_begin: address.time_begin,
                                    time_end: address.time_end,
                                    location_name: address.location_name
                                });
                            } else {
                                console.error(`Geocode error for address "${address.address}": ${status}`);
                                reject(status);
                            }
                        });
                    })
                );

                Promise.all(geocodePromises)
                    .then(results => callback(results, map))
                    .catch(error => console.error('Geocode error: ' + error));
            }

            function addWaypointsToMap(geocodedAddresses, map) {
                geocodedAddresses.forEach(({ position, location }) => {
                    new google.maps.Marker({
                        map: map,
                        position: position,
                        title: location
                    });
                });
            }

            function addDetailsToWaypoints(geocodedAddresses, map) {
                geocodedAddresses.forEach(({ position, location, date, time_begin, time_end, location_name, address }) => {
                    const marker = new google.maps.Marker({
                        map: map,
                        position: position,
                        title: location
                    });

                    const infoWindow = new google.maps.InfoWindow({
                        content: `<h3>${location}</h3>
                <p>Date: ${date}</p>
                <p>Time: ${time_begin} - ${time_end}</p>
                <p>Location Name: ${location_name}</p>`
                    });

                    marker.addListener('click', () => {
                        if (currentInfoWindow) {
                            currentInfoWindow.close();
                        }
                        infoWindow.open(map, marker);
                        currentInfoWindow = infoWindow;
                    });
                });
            }

            function calculateRoute(destinationLat, destinationLng) {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition((position) => {
                        const origin = new google.maps.LatLng(position.coords.latitude, position.coords.longitude);
                        const destination = new google.maps.LatLng(destinationLat, destinationLng);

                        const request = {
                            origin: origin,
                            destination: destination,
                            travelMode: 'DRIVING'
                        };

                        directionsService.route(request, (result, status) => {
                            if (status === 'OK') {
                                directionsRenderer.setDirections(result);
                                if (currentInfoWindow) {
                                    currentInfoWindow.setContent(`${currentInfoWindow.getContent()}<p>Estimated Driving time: ${result.routes[0].legs[0].duration.text}</p>`);
                                }
                            } else {
                                console.error(`Directions request failed due to ${status}`);
                            }
                        });
                    }, () => {
                        console.error('Geolocation service failed.');
                    });
                } else {
                    console.error('Browser does not support geolocation.');
                }
            }

            window.onload = initMap;
        </script>
    </section>


  <div class="fkwebsite">
                <img src="{{ url_for('static', filename='fkthis.jpg') }}" alt="">
            </div>

            <div id="progress-bar">
                    <progress id="progress" value="0" max="100"></progress>
                    
                </div>
        
        
                <div id="quiz-container" class="testpage-quiz">
            <div class="start" style="display: block;">
                <p>Put your new knowledge on updates to the test, take our quiz!</p>
                  <button>Start Quiz</button>
            </div>
            <!-- 进度条 -->
            

             <div class="game" style="display: none;">
                

                <span id="progress-text">Question 1 of 3</span>
                
    
                <div class="question" id="question-1" data-correct="2" style="display: none;">
                    <p></p>
                    
                    <div id="option-container">
                        
                    </div>
                    <button id="next-option" style="display: none;">Next</button> <!-- 唯一的按鈕 ID -->
                </div>
                
                <div class="question" id="question-2" data-correct="0" style="display: none;">
                    <p></p>
                    <div id="option-container">
                        
                    </div>
                    <button id="next-option" style="display: none;">Next</button>
                </div>
    
                <div class="question" id="question-3" data-correct="0" style="display: none;">
                    <p></p>
                    <div id="option-container">
                        
                    </div>
                    <button id="next-option" style="display: none;">Done</button>
                </div>
             </div>
            <script>
                 const start = document.querySelector('.start')
                 const game = document.querySelector('.game')
                 const button = document.querySelector('.start button')
                 button.addEventListener('click', () => {
                   start.style.display = 'none'
                   game.style.display = 'block'
                 })
            </script>


                <!-- 按鈕: 下一題 -->
                <div id="result"></div>
                
        </div>

</div>

<script src="/static/script_quiz2.js"></script>

<script src="/static/script_quiz3.js"></script>









<!-- End of the specific container -->

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAgYZxufphoIQdLoTbmvDRw_NznG6pPjmM" async defer></script>

<!-- Scripts for youtube video iframes -->
<script src="https://www.youtube.com/iframe_api"></script>
<script src="{{ url_for('static', filename='youtube_iframe_api_for_education.js') }}"></script>

<script src="{{ url_for('static', filename='script.js') }}"></script>

{% endblock %}